CREATE DATABASE oficina;
USE oficina;

CREATE TABLE clientes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    telefone VARCHAR(20),
    cep VARCHAR(10),
    endereco VARCHAR(255),
    cidade VARCHAR(100),
    estado VARCHAR(50)
);

CREATE TABLE fornecedores (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255) NOT NULL,
    telefone VARCHAR(20),
    email VARCHAR(255),
    cep VARCHAR(10),
    endereco VARCHAR(255),
    cidade VARCHAR(100),
    estado VARCHAR(50)
);

CREATE TABLE categorias (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    descricao TEXT
);

CREATE TABLE produtos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255) NOT NULL,
    categoria_id INT,
    fornecedor_id INT,
    preco DECIMAL(10, 2) NOT NULL,
    quantidade_em_estoque INT NOT NULL,
    FOREIGN KEY (categoria_id) REFERENCES categorias(id),
    FOREIGN KEY (fornecedor_id) REFERENCES fornecedores(id)
);

CREATE TABLE vendas (
    id INT PRIMARY KEY AUTO_INCREMENT,
    cliente_id INT,
    data_venda DATE DEFAULT NOW(),
    valor_total DECIMAL(10, 2) NOT NULL,
    status ENUM('Pendente', 'Concluida', 'Canceleda') DEFAULT 'Pendente',
    FOREIGN KEY (cliente_id) REFERENCES clientes(id)
);

CREATE TABLE itens_venda (
    id INT PRIMARY KEY AUTO_INCREMENT,
    venda_id INT,
    produto_id INT,
    quantidade INT NOT NULL,
    preco_total DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (venda_id) REFERENCES vendas(id),
    FOREIGN KEY (produto_id) REFERENCES produtos(id)
);

CREATE TABLE pagamentos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    venda_id INT,
    forma_pagamento ENUM('cartão', 'boleto', 'dinheiro') NOT NULL,
    valor_pago DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (venda_id) REFERENCES vendas(id)
);

CREATE TABLE estoque_movimentacao (
    id INT PRIMARY KEY AUTO_INCREMENT,
    produto_id INT,
    tipo_movimentacao ENUM('entrada', 'saída') NOT NULL,
    quantidade INT NOT NULL,
    FOREIGN KEY (produto_id) REFERENCES produtos(id)
);


INSERT INTO clientes (nome, email, telefone, cep, endereco, cidade, estado) 
VALUES("Pedro Ferreira", "pedrindomel23@gmail.com", "75981652872", "43075721", "rua buenos aires", "Feira de Santana", "Bahia");

INSERT INTO clientes (nome, email, telefone, cep, endereco, cidade, estado) 
VALUES("Joao Saturino", "joaolinux13@gmail.com", "75991582872", "44075721", "rua Brasil", "Feira de Santana", "Bahia");

INSERT INTO clientes (nome, email, telefone, cep, endereco, cidade, estado) 
VALUES("Matheus Alcatra", "mateusaucanta@gmail.com", "75981652332", "43045721", "rua Volta Redonda", "Feira de Santana", "Bahia");
